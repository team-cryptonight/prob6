\documentclass{article}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{kotex}
\usepackage[backend=biber]{biblatex}
\usepackage{hyperref}

\addbibresource{citation.bib}
\setmainhangulfont[ItalicFont={*},ItalicFeatures={FakeSlant=.22}]{Noto Serif CJK KR}

\newtheorem{definition}{정의}
\newtheorem{theorem}{정리}

\newcommand{\adv}{\mathbf{Adv}}

\title{6번 문제 풀이}
\author{Crypto Night}

\begin{document}
  \maketitle

  \section{Padding Scheme}
  블록 길이 \(x\)인 패딩 함수 \(\mathrm{pad}[x]\)가 빈 문자열에 대응되지 않고, 다음을 만족시킬 때, \(\mathrm{pad}\)는 sponge-complaint하다고 한다.\cite{guido_cryptographic_2011}

  \begin{align*}
    \forall n \geq 0, \forall M, M' \in \mathbb{Z}^*_2 : M \not=M' \Rightarrow M \| \mathrm{pad}[r](|M|) \not= M' \| \mathrm{pad}[r](|M'|) \| 0^{nr}
  \end{align*}

  이 조건을 만족하면서 가장 간단한 패딩 방법으로 multirate padding \(\mathrm{pad10^*1}\)을 사용할 것이다.

  \begin{definition}
    Multirate padding \(\mathrm{pad10^*1}[x]\)는 메시지의 맨 뒤에 1을 붙이고, 패딩 결과의 길이가 블록 길이 \(x\)의 배수가 되게 하는 최소 개수의 0과 한 개의 1을 붙인다.
  \end{definition}

  또한, 우리의 해시 함수에서는 직접적으로 사용되지는 않지만 이후의 증명에서 사용할 \(10^*\)-padding \(\mathrm{pad10^*}[x]\)를 다음과 같이 정의한다.

  \begin{definition}
    \(10^*\)-padding \(\mathrm{pad10^*}[x]\)는 메시지의 맨 뒤에 1을 붙이고, 패딩 결과가 블록 길이 \(x\)의 배수가 되게 하는 최소 개수의 0을 덧붙인다.
  \end{definition}

  \section{Indifferentiability Proof}
  \(b, c, r, n \in \mathbb{N}, b = c + r\)이고, \(\mathcal{P}\)를 \(b\)-bit permutation, \(\mathrm{pad}\)를 \(r\)비트 블록으로 변환하는 injective padding이라고 하자. Padding된 마지막 블록은 non-zero여야 한다.
  (TODO: generalized sponge construction \(\mathcal{S}[\mathcal{P}, \mathrm{pad}, r]\)  정의 완성)

  한편, 문제에서 설명하는 해시 함수를 \(\mathcal{S}'[\mathcal{P}, \mathrm{pad}, r_1, r_2, r_3]\)라고 정의하면, 다음이 성립한다.

  \begin{theorem}[두 construction의 관계]
    \(10^*\)-padding \(\mathrm{pad10^*}\)과 \(10^*1\)-padding \(\mathrm{pad10^*1}\)을 정의할 때, 모든 bitrate \(0 \leq r_1, r_2, r_3 \leq r_\mathrm{max}\)에 대해 함수 \(I[r_1, r_2, r_\mathrm{max}], O[r_3, r_\mathrm{max}]\)가 존재하고, 다음 관계를 만족한다.

    \begin{align*}
      \mathcal{S}'[\mathcal{P}, \mathrm{pad10^*1}, r_1, r_2, r_3] = O[r_3, r_\mathrm{max}] \circ \mathcal{S}[\mathcal{P}, \mathrm{pad10^*}, r_\mathrm{max}, r_3] \circ I[r_1, r_2, r_\mathrm{max}]
    \end{align*}

    여기에서 \(f \circ g\)는 함수의 합성을 의미한다.
  \end{theorem}
  \begin{proof}
    (TODO: 증명 완성)
  \end{proof}

  \begin{theorem}[Indifferentiability]
    \(\mathcal{S}'[h, \mathrm{pad10^*1}, r_1, r_2, r_3]\)를 random oracle과 구분하는 것과 \(\mathcal{S}[h, \mathrm{pad10^*}, r_\mathrm{max}, r_3]\)를 random oracle과 구분하는 advantage는 같다.
  \end{theorem}
  \begin{proof}
    (TODO: 증명 완성)
  \end{proof}

  \section{Preimage Resistance Lower Bound}
  우리는 여기에서 everywhere preimage resistance에 집중할 것이다.\cite{rogaway_cryptographic_2004} 문제의 해시 함수 \(\mathcal{H}\)와 random oracle \(\mathcal{R}\)에서 다음이 성립한다.\cite{andreeva_security_2011} 여기서 \(q\)는 adversary가 \(\mathcal{P}, \mathcal{P}^{-1}\)에 접근하는 횟수이다.

  \begin{align}\label{epre_adv_bound}
    \adv^\text{epre}_\mathcal{H}(q) \leq \adv^\text{indif}_\mathcal{H}(q) + \adv^\text{epre}_\mathcal{R}(q)
  \end{align}

  여기서 \(\adv^\text{indif}_\mathcal{R}(q)\)는 primitive \(\pi\)를 기반으로 하는 해시함수 \((\mathcal{H}, \pi)\)를 어떤 simulator \(S\)에 대해 random oracle \((\mathcal{R}, S)\)로부터 구분하는 advantage로 정의된다. \(\adv^\text{epre}_\mathcal{R}=q/2^n, \adv^\text{indif}_\mathcal{H}(q)\leq \frac{q(q + 1)}{2^{c + 1}}\)에서 다음을 얻는다.

  \begin{align*}
    \adv^\text{epre}_\mathcal{H}(q) \leq \frac{q}{2^n} + \frac{q(q + 1)}{2^{c + 1}}
  \end{align*}

  \(\adv^\text{pre}_\mathcal{H}(q) \leq \adv^\text{epre}_\mathcal{H}(q)\)이므로\cite{rogaway_cryptographic_2004}, preimage attack이 최소 \(\mathrm{min}\{2^{c/2}, 2^n\}\)의 접근이 필요함을 알 수 있다.

  \section{Collision Resistance Lower Bound}
  (\ref{epre_adv_bound})의 식과 비슷하게, 다음이 성립한다.

  \begin{align*}
    \adv^\text{coll}_\mathcal{H}(q) \leq \adv^\text{indif}_\mathcal{H}(q) + \adv^\text{coll}_\mathcal{R}(q)
  \end{align*}

  여기에서 \(\adv^\text{coll}_\mathcal{R}(q) \leq \frac{q^2}{2^{n - 1}}\)이므로 다음을 얻는다.

  \begin{align*}
    \adv^\text{coll}_\mathcal{H}(q) \leq \frac{q^2}{2^{n - 1}} + \frac{q(q + 1)}{2^{c + 1}}
  \end{align*}

  이 결과를 이용하면 collision attack에 최소 \(\mathrm{min}\{2^{c/2}, 2^{n/2}\}\)의 접근이 필요함을 알 수 있다.

  \section{Second Preimage Resistance Lower Bound}
  Collision resistance는 second preimage reistance를 함의함이 증명되어 있다.\cite{rogaway_cryptographic_2004} 다르게 말하면, 다음이 성립한다.

  \begin{align*}
    \adv^\text{sec}_\mathcal{H}(q) \leq \adv^\text{coll}_\mathcal{H}(q)
  \end{align*}

  따라서 second preimage attack에도 최소 \(\mathrm{min}\{2^{c/2}, 2^{n/2}\}\)의 접근이 필요함을 알 수 있다.
  \printbibliography
\end{document}
